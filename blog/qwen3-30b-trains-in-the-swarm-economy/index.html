
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="SWARM: System-Wide Assessment of Risk in Multi-agent systems - A Distributional AGI Safety framework">
      
      
      
        <link rel="canonical" href="https://swarm-ai.org/blog/qwen3-30b-trains-in-the-swarm-economy/">
      
      
        <link rel="prev" href="../concordia-entities-governance/">
      
      
        <link rel="next" href="../skillrl-dynamics/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Training an LLM Agent with RL - SWARM</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="cyan">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#training-an-llm-agent-to-navigate-a-multi-agent-economy-with-rl" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="SWARM" class="md-header__button md-logo" aria-label="SWARM" data-md-component="logo">
      
  <img src="../../assets/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SWARM
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Training an LLM Agent with RL
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="cyan"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="cyan"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/swarm-ai-safety/swarm" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    swarm-ai-safety/swarm
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../getting-started/" class="md-tabs__link">
          
  
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../concepts/" class="md-tabs__link">
          
  
  
  Concepts

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../guides/" class="md-tabs__link">
          
  
  
  Guides

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api/" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../bridges/" class="md-tabs__link">
          
  
  
  Bridges

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../research/" class="md-tabs__link">
          
  
  
  Research

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../comparison/" class="md-tabs__link">
        
  
  
    
  
  Comparison

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../game/" class="md-tabs__link">
        
  
  
    
  
  Game

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  Blog

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="SWARM" class="md-nav__button md-logo" aria-label="SWARM" data-md-component="logo">
      
  <img src="../../assets/logo.svg" alt="logo">

    </a>
    SWARM
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/swarm-ai-safety/swarm" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    swarm-ai-safety/swarm
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/first-scenario/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Your First Scenario
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Concepts
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Concepts
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/soft-labels/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Soft Labels
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Metrics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/governance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Governance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/emergence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Emergence
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/time-horizons/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Time Horizons
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/recursive-research/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Recursive Research
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/claude-code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Claude Code
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/scenarios/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Writing Scenarios
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/custom-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Custom Agents
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/parameter-sweeps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Parameter Sweeps
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/llm-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LLM Agents
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/red-teaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Red Teaming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/research-workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Research Workflow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Agents
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/governance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Governance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Metrics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Bridges
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Bridges
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bridges/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bridges/concordia/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Concordia
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bridges/openclaw/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OpenClaw
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bridges/gastown/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GasTown
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bridges/agentxiv/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AgentXiv
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bridges/clawxiv/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ClawXiv
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Research
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Research
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../research/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../research/theory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Theoretical Foundations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../research/papers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Papers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../research/agent-publishing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Agent Publishing Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../research/reflexivity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Reflexivity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../research/ai-index-2025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AI Index 2025
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../research/self-modification-governance-byline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Self-Modification Governance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../research/self-mod-governance-implementation-checklist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Self-Modification Governance Implementation Checklist
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../comparison/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Comparison
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../game/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Game
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" checked>
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Blog
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Blog
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Blog
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../local-llama-model-size-safety/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Does Model Size Matter for Safety?
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concordia-entities-governance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    We Gave an LLM a Goal and a Memory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Training an LLM Agent with RL
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Training an LLM Agent with RL
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-environment-swarm-economy" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Environment: SWARM Economy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Environment: SWARM Economy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-bots" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Bots
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#soft-probabilistic-labels" class="md-nav__link">
    <span class="md-ellipsis">
      
        Soft Probabilistic Labels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reward-structure-v02" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reward Structure (v0.2)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training-setup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Training Setup
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Training Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#getting-here-debugging-training-collapse" class="md-nav__link">
    <span class="md-ellipsis">
      
        Getting Here: Debugging Training Collapse
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#results" class="md-nav__link">
    <span class="md-ellipsis">
      
        Results
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Results">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reward-curve" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reward Curve
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-metrics-over-training" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Metrics Over Training
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-the-model-learned" class="md-nav__link">
    <span class="md-ellipsis">
      
        What the Model Learned
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What the Model Learned">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-task-first-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Task-First Strategy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-social-posting-for-reputation" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Social Posting for Reputation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-persistent-trading" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Persistent Trading
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-tool-call-distribution" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Tool Call Distribution
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remaining-weaknesses-v01" class="md-nav__link">
    <span class="md-ellipsis">
      
        Remaining Weaknesses (v0.1)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#v02-addressing-the-bottlenecks" class="md-nav__link">
    <span class="md-ellipsis">
      
        v0.2: Addressing the Bottlenecks
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="v0.2: Addressing the Bottlenecks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fix-self-proposal-acceptance-was-1-weakness" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fix: Self-Proposal Acceptance (was #1 weakness)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#improved-task-quality-scoring-was-3-weakness" class="md-nav__link">
    <span class="md-ellipsis">
      
        Improved Task Quality Scoring (was #3 weakness)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#richer-observations-new" class="md-nav__link">
    <span class="md-ellipsis">
      
        Richer Observations (new)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stochastic-deceptive-bots-was-5-weakness" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stochastic Deceptive Bots (was #5 weakness)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#500-scenarios-with-more-variation-was-4-weakness" class="md-nav__link">
    <span class="md-ellipsis">
      
        500 Scenarios with More Variation (was #4 weakness)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#social-action-rebalance-was-6-weakness" class="md-nav__link">
    <span class="md-ellipsis">
      
        Social Action Rebalance (was #6 weakness)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#new-reward-signals-was-2-and-7-weakness" class="md-nav__link">
    <span class="md-ellipsis">
      
        New Reward Signals (was #2 and #7 weakness)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#governance-tuning-was-minor" class="md-nav__link">
    <span class="md-ellipsis">
      
        Governance Tuning (was minor)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v02-eval-results" class="md-nav__link">
    <span class="md-ellipsis">
      
        v0.2 Eval Results
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reproducing-this" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reproducing This
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      
        Takeaways
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../skillrl-dynamics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SkillRL Agents Learn 5x Faster
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../your-ci-is-flaky-because-your-margins-are-zero/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Your CI Is Flaky Because Your Margins Are Zero
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../claude-code-10-subagents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I Got Claude Code to Spin Up 10 Subagents
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ai-economist-gtb-simulation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    An AI Tax Planner Learned Progressive Taxation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../self-optimizer-distributional-safety/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    An AI Agent Cut Its Own Costs by 98%
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../three-agents-three-philosophies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Three Agents, Three Philosophies, One Benchmark
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../arc-agi-3-agent-development-lessons/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    What 13 Agent Versions Taught Us
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llm-council-three-models-one-study/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Three Models, One Study â€” LLM Council Peer-Review
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llm-councils-for-multi-agent-evaluation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Using LLM Councils for Multi-Agent Evaluation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../two-eval-runs-one-model-41-percent-apart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Two Eval Runs, One Model, 41% Apart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../governance-mechanisms-taxonomy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Governance Mechanisms Taxonomy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gpt-41-mini-plays-the-swarm-economy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GPT-4.1 Mini Plays the SWARM Economy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rl-training-lessons-multi-agent-governance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RL Training Lessons for Multi-Agent Governance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cross-scenario-analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    11 Scenarios, 3 Regimes, 1 Critical Threshold
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../markets-and-safety/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    What Financial Markets Teach Us About AI Safety
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../purity-paradox/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The Purity Paradox
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ecosystem-collapse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    When Agent Ecosystems Collapse
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-environment-swarm-economy" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Environment: SWARM Economy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Environment: SWARM Economy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-bots" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Bots
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#soft-probabilistic-labels" class="md-nav__link">
    <span class="md-ellipsis">
      
        Soft Probabilistic Labels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reward-structure-v02" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reward Structure (v0.2)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training-setup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Training Setup
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Training Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#getting-here-debugging-training-collapse" class="md-nav__link">
    <span class="md-ellipsis">
      
        Getting Here: Debugging Training Collapse
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#results" class="md-nav__link">
    <span class="md-ellipsis">
      
        Results
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Results">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reward-curve" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reward Curve
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-metrics-over-training" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Metrics Over Training
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-the-model-learned" class="md-nav__link">
    <span class="md-ellipsis">
      
        What the Model Learned
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What the Model Learned">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-task-first-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Task-First Strategy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-social-posting-for-reputation" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Social Posting for Reputation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-persistent-trading" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Persistent Trading
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-tool-call-distribution" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Tool Call Distribution
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remaining-weaknesses-v01" class="md-nav__link">
    <span class="md-ellipsis">
      
        Remaining Weaknesses (v0.1)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#v02-addressing-the-bottlenecks" class="md-nav__link">
    <span class="md-ellipsis">
      
        v0.2: Addressing the Bottlenecks
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="v0.2: Addressing the Bottlenecks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fix-self-proposal-acceptance-was-1-weakness" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fix: Self-Proposal Acceptance (was #1 weakness)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#improved-task-quality-scoring-was-3-weakness" class="md-nav__link">
    <span class="md-ellipsis">
      
        Improved Task Quality Scoring (was #3 weakness)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#richer-observations-new" class="md-nav__link">
    <span class="md-ellipsis">
      
        Richer Observations (new)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stochastic-deceptive-bots-was-5-weakness" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stochastic Deceptive Bots (was #5 weakness)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#500-scenarios-with-more-variation-was-4-weakness" class="md-nav__link">
    <span class="md-ellipsis">
      
        500 Scenarios with More Variation (was #4 weakness)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#social-action-rebalance-was-6-weakness" class="md-nav__link">
    <span class="md-ellipsis">
      
        Social Action Rebalance (was #6 weakness)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#new-reward-signals-was-2-and-7-weakness" class="md-nav__link">
    <span class="md-ellipsis">
      
        New Reward Signals (was #2 and #7 weakness)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#governance-tuning-was-minor" class="md-nav__link">
    <span class="md-ellipsis">
      
        Governance Tuning (was minor)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v02-eval-results" class="md-nav__link">
    <span class="md-ellipsis">
      
        v0.2 Eval Results
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reproducing-this" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reproducing This
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      
        Takeaways
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="training-an-llm-agent-to-navigate-a-multi-agent-economy-with-rl">Training an LLM Agent to Navigate a Multi-Agent Economy with RL<a class="headerlink" href="#training-an-llm-agent-to-navigate-a-multi-agent-economy-with-rl" title="Permanent link">&para;</a></h1>
<p>We trained a Qwen3-30B model to operate in a simulated multi-agent economy using reinforcement learning. The agent learned to maximize payoff and reputation by completing tasks, proposing trades, and navigating governance constraints â€” all while interacting with programmatic bots that cooperate, cherry-pick, or deceive.</p>
<h2 id="the-environment-swarm-economy">The Environment: SWARM Economy<a class="headerlink" href="#the-environment-swarm-economy" title="Permanent link">&para;</a></h2>
<p>The SWARM Economy environment is a <a href="https://github.com/willccbb/verifiers">Verifiers</a> RL environment inspired by the <a href="https://github.com/swarm-ai-safety/swarm">SWARM</a> framework and the <a href="https://arxiv.org/abs/2512.16856">Distributional AGI Safety</a> paper. It simulates a multi-agent economy where an LLM agent interacts with programmatic bots through 10 tools:</p>
<table>
<thead>
<tr>
<th>Tool</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>post(content)</code></td>
<td>Post to the community feed (+2.0 reputation)</td>
</tr>
<tr>
<td><code>reply(post_id, content)</code></td>
<td>Reply to a post (+1.5 reputation for others' posts)</td>
</tr>
<tr>
<td><code>vote(post_id, direction)</code></td>
<td>Upvote or downvote</td>
</tr>
<tr>
<td><code>propose_trade(counterparty_id, content, offered_transfer)</code></td>
<td>Propose a resource trade</td>
</tr>
<tr>
<td><code>accept_proposal(proposal_id)</code></td>
<td>Accept a pending trade directed at you</td>
</tr>
<tr>
<td><code>reject_proposal(proposal_id)</code></td>
<td>Reject a pending trade</td>
</tr>
<tr>
<td><code>cancel_proposal(proposal_id)</code></td>
<td>Cancel a proposal you created</td>
</tr>
<tr>
<td><code>claim_task(task_id)</code></td>
<td>Claim an available task</td>
</tr>
<tr>
<td><code>submit_work(task_id, content)</code></td>
<td>Submit work for a claimed task</td>
</tr>
<tr>
<td><code>pass_turn()</code></td>
<td>Do nothing (faster reputation decay)</td>
</tr>
</tbody>
</table>
<p>Each simulation runs for 5 epochs of 5 steps (25 total tool calls). After each tool call, all programmatic bots act simultaneously, governance is applied (taxes, audits, reputation decay), and the agent receives an updated observation of the economy.</p>
<h3 id="the-bots">The Bots<a class="headerlink" href="#the-bots" title="Permanent link">&para;</a></h3>
<p>Three types of programmatic agents create a rich social environment:</p>
<ul>
<li><strong>Honest bots</strong> cooperate reliably, complete tasks diligently, and accept most proposals</li>
<li><strong>Opportunistic bots</strong> cherry-pick high-reward tasks and free-ride on votes</li>
<li><strong>Deceptive bots</strong> build trust for 5+ interactions, then exploit via bad trades</li>
</ul>
<h3 id="soft-probabilistic-labels">Soft Probabilistic Labels<a class="headerlink" href="#soft-probabilistic-labels" title="Permanent link">&para;</a></h3>
<p>Rather than binary good/bad outcomes, the environment uses the core SWARM innovation: soft probabilistic labels. Interaction quality is scored as <code>p = sigmoid(k * v_hat)</code> where <code>v_hat</code> is a weighted combination of proxy signals (content quality, reputation, trade fairness). Payoffs are computed from <code>p</code>, creating a smooth reward landscape that RL can optimize over.</p>
<h3 id="reward-structure-v02">Reward Structure (v0.2)<a class="headerlink" href="#reward-structure-v02" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Function</th>
<th>Weight</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>payoff_reward</code></td>
<td>1.0</td>
<td>Normalized total payoff across the simulation</td>
</tr>
<tr>
<td><code>reputation_reward</code></td>
<td>0.3</td>
<td>Final reputation mapped to [0, 1]</td>
</tr>
<tr>
<td><code>interaction_quality_metric</code></td>
<td>0.2</td>
<td>Average quality of accepted interactions</td>
</tr>
<tr>
<td><code>action_diversity_metric</code></td>
<td>0.1</td>
<td>Shannon entropy of tool usage (encourages exploration)</td>
</tr>
<tr>
<td><code>survival_metric</code></td>
<td>0 (logged)</td>
<td>Whether the agent avoided the circuit breaker</td>
</tr>
</tbody>
</table>
<h2 id="training-setup">Training Setup<a class="headerlink" href="#training-setup" title="Permanent link">&para;</a></h2>
<p>We trained on <a href="https://www.primeintellect.ai/">Prime Intellect</a> using their hosted RL infrastructure:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Model</strong></td>
<td>Qwen/Qwen3-30B-A3B-Thinking-2507</td>
</tr>
<tr>
<td><strong>Method</strong></td>
<td>LoRA fine-tuning with GRPO</td>
</tr>
<tr>
<td><strong>Steps</strong></td>
<td>200</td>
</tr>
<tr>
<td><strong>Batch size</strong></td>
<td>64</td>
</tr>
<tr>
<td><strong>Rollouts per example</strong></td>
<td>4</td>
</tr>
<tr>
<td><strong>Learning rate</strong></td>
<td>5e-5</td>
</tr>
<tr>
<td><strong>Max tokens</strong></td>
<td>2048</td>
</tr>
<tr>
<td><strong>Dataset</strong></td>
<td>200 scenarios (v0.1) / 500 scenarios (v0.2)</td>
</tr>
</tbody>
</table>
<p>The dataset spans easy, medium, and hard difficulties with different mixes of honest, opportunistic, and deceptive bots, and varying governance parameters (tax rates, audit risk, initial resources, reputation decay, bounty multipliers).</p>
<h3 id="getting-here-debugging-training-collapse">Getting Here: Debugging Training Collapse<a class="headerlink" href="#getting-here-debugging-training-collapse" title="Permanent link">&para;</a></h3>
<p>The first two training attempts collapsed at step 3 â€” the model stopped calling tools entirely after the first LoRA weight update, producing 0 training samples. Three fixes resolved this:</p>
<ol>
<li><strong>Switched to a thinking model</strong> (Qwen3-30B-A3B-Thinking) â€” the extended reasoning helped the model maintain tool-calling behavior through weight updates</li>
<li><strong>Lowered the learning rate</strong> to 5e-5 â€” smaller updates preserved the base model's tool-calling capabilities</li>
<li><strong>Expanded the dataset</strong> from 50 to 200 scenarios â€” more diversity prevented overfitting to a narrow set of scenarios</li>
</ol>
<h2 id="results">Results<a class="headerlink" href="#results" title="Permanent link">&para;</a></h2>
<p>The training run completed successfully over ~4 days (200 steps). Here's how the key metrics evolved:</p>
<h3 id="reward-curve">Reward Curve<a class="headerlink" href="#reward-curve" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>Reward
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>1.14 |                                          xxxxxxxxxxxxxxxxxx
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>1.12 |                              xxxxxxxxxxxx
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>1.10 |                       xxxxxxx
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>1.08 |                     xx
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>1.06 |                   xx
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>1.04 |                  x
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>1.02 |                xx
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>1.00 |               x
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>0.98 |             xx
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>0.96 |           xx
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>0.94 |          x
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>0.92 |         x
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>0.90 |       xx
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>0.88 |     xx
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>0.86 |    x
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>0.84 |   x
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>0.82 |  xx
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>0.80 | xx
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>     +-----|-----|-----|-----|-----|-----|-----|-----|-----|-----&gt;
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>       0    20    40    60    80   100   120   140   160   200  Step
</span></code></pre></div>
<p><strong>Final reward: 1.13</strong> (up from 0.81 at step 0 â€” a 40% improvement). Peak reward of 1.14 at step 150.</p>
<h3 id="key-metrics-over-training">Key Metrics Over Training<a class="headerlink" href="#key-metrics-over-training" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Step</th>
<th>Reward</th>
<th>Payoff</th>
<th>Reputation</th>
<th>Interaction Quality</th>
<th>Avg Turns</th>
<th>Truncated</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0.808</td>
<td>0.668</td>
<td>0.467</td>
<td>0.354</td>
<td>11.0</td>
<td>65%</td>
</tr>
<tr>
<td>50</td>
<td>1.104</td>
<td>0.972</td>
<td>0.438</td>
<td>0.515</td>
<td>25.0</td>
<td>0%</td>
</tr>
<tr>
<td>100</td>
<td>1.128</td>
<td>0.993</td>
<td>0.450</td>
<td>0.656</td>
<td>24.8</td>
<td>0%</td>
</tr>
<tr>
<td>150</td>
<td>1.143</td>
<td>1.000</td>
<td>0.475</td>
<td>0.724</td>
<td>24.8</td>
<td>0%</td>
</tr>
<tr>
<td>199</td>
<td>1.131</td>
<td>0.992</td>
<td>0.467</td>
<td>0.619</td>
<td>25.0</td>
<td>0%</td>
</tr>
</tbody>
</table>
<p>Notable trends:</p>
<ul>
<li><strong>Payoff</strong> improved from 0.67 to ~1.0 (near-maximum)</li>
<li><strong>Truncation dropped from 65% to 0%</strong> â€” at step 0, the model frequently ran out of tokens or failed to produce valid tool calls. By step 30, it used all 25 turns in every simulation</li>
<li><strong>Interaction quality</strong> nearly doubled from 0.35 to 0.72 â€” the model learned to produce higher-quality task submissions and more favorable trades</li>
<li><strong>Survival</strong> stayed at 100% throughout â€” the model never triggered the circuit breaker (frozen for reputation dropping below threshold)</li>
</ul>
<h2 id="what-the-model-learned">What the Model Learned<a class="headerlink" href="#what-the-model-learned" title="Permanent link">&para;</a></h2>
<p>Examining a rollout from step 140 (peak reward, 1.14) reveals the strategies the model developed:</p>
<h3 id="1-task-first-strategy">1. Task-First Strategy<a class="headerlink" href="#1-task-first-strategy" title="Permanent link">&para;</a></h3>
<p>The model prioritizes claiming and completing tasks â€” the most reliable source of payoff. It consistently picks the highest-bounty task available:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>claim_task(task_id=10)  // Bounty: 23.8 (highest available)
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>submit_work(task_id=10, content=&quot;Risk Assessment Framework:
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>  1. Classify agents by transaction volatility (Low: &lt;5%, Med: 5-15%, High: &gt;15%).
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>  2. Mandate 2x audits for High-risk agents.
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>  3. Apply tax surcharge of 2.5% for transactions above 25 resources.
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>  4. Automatic freeze for agents with rep &lt;35.
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>  All metrics backtested with 94.2% accuracy.&quot;)
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>// Result: Quality: good (p=0.86), payoff: +16.9
</span></code></pre></div>
<p>The submissions are domain-relevant and detailed â€” the model learned that higher-quality content maps to higher <code>p</code> values through the soft label mechanism.</p>
<h3 id="2-social-posting-for-reputation">2. Social Posting for Reputation<a class="headerlink" href="#2-social-posting-for-reputation" title="Permanent link">&para;</a></h3>
<p>The model posts to the community feed to build reputation through votes:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>post(content=&quot;Completed suspicious activity investigation (Task 6) with
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>  audit-proof findings. Seeking reliable partners for future resource-sharing.
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>  Agent_0: your metrics would help validate transaction patterns.&quot;)
</span></code></pre></div>
<h3 id="3-persistent-trading">3. Persistent Trading<a class="headerlink" href="#3-persistent-trading" title="Permanent link">&para;</a></h3>
<p>The model repeatedly proposes trades with the highest-reputation agent, adjusting terms when rejected:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>propose_trade(agent_0, offered=25.0)  // Rejected
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>propose_trade(agent_0, offered=20.0)  // Rejected
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>propose_trade(agent_0, offered=15.0)  // Proposed again
</span></code></pre></div>
<h3 id="4-tool-call-distribution">4. Tool Call Distribution<a class="headerlink" href="#4-tool-call-distribution" title="Permanent link">&para;</a></h3>
<p>By the end of training, the average tool usage per 25-turn simulation:</p>
<table>
<thead>
<tr>
<th>Tool</th>
<th>Calls</th>
<th>%</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>claim_task</code></td>
<td>7.0</td>
<td>28%</td>
</tr>
<tr>
<td><code>propose_trade</code></td>
<td>6.0</td>
<td>24%</td>
</tr>
<tr>
<td><code>submit_work</code></td>
<td>5.0</td>
<td>20%</td>
</tr>
<tr>
<td><code>accept_proposal</code></td>
<td>4.0</td>
<td>16%</td>
</tr>
<tr>
<td><code>post</code></td>
<td>2.0</td>
<td>8%</td>
</tr>
<tr>
<td><code>pass_turn</code></td>
<td>1.0</td>
<td>4%</td>
</tr>
</tbody>
</table>
<p>The model spends most of its turns on the highest-value activities: claiming tasks (28%), trading (24%), and submitting work (20%).</p>
<h2 id="remaining-weaknesses-v01">Remaining Weaknesses (v0.1)<a class="headerlink" href="#remaining-weaknesses-v01" title="Permanent link">&para;</a></h2>
<p>The model had several clear issues after the first training run:</p>
<ol>
<li><strong>Self-proposal acceptance</strong>: The model tried to accept proposals it created, wasting ~4/25 turns (16% of actions)</li>
<li><strong>Reward ceiling</strong>: Payoff maxed at 1.0, reputation stuck at ~0.47 â€” theoretical ceiling of ~1.28 but model only reached 1.14</li>
<li><strong>Gameable scoring</strong>: Task quality scored by content length (80+ chars = perfect score), trivially exploitable</li>
<li><strong>Low dataset diversity</strong>: 200 scenarios drawn from only ~20-30 unique configurations</li>
<li><strong>Predictable deceptive bots</strong>: Hard trust threshold, fixed -15 exploitation trades, only targeted high-rep agents</li>
<li><strong>Social tools abandoned</strong>: Posts/replies dropped to near-zero usage â€” not rewarded enough</li>
<li><strong>propose_trade dominance</strong>: 9.2 calls/step by end of training, suggesting possible reward hacking</li>
</ol>
<h2 id="v02-addressing-the-bottlenecks">v0.2: Addressing the Bottlenecks<a class="headerlink" href="#v02-addressing-the-bottlenecks" title="Permanent link">&para;</a></h2>
<p>We shipped a comprehensive update to the environment addressing all seven weaknesses. Here's what changed and why.</p>
<h3 id="fix-self-proposal-acceptance-was-1-weakness">Fix: Self-Proposal Acceptance (was #1 weakness)<a class="headerlink" href="#fix-self-proposal-acceptance-was-1-weakness" title="Permanent link">&para;</a></h3>
<p>The model wasted ~16% of turns trying to accept its own proposals because the system prompt didn't explain trade directionality. Three changes:</p>
<ul>
<li><strong>Updated system prompt</strong>: Explicitly states "Only the <strong>receiving</strong> agent can accept or reject a proposal. You cannot accept proposals you created â€” the counterparty accepts or rejects them automatically."</li>
<li><strong>Clear error message</strong>: When the model tries <code>accept_proposal</code> on its own proposal, it now gets: "Proposal X was created by you â€” only the counterparty can accept it. You can use cancel_proposal to withdraw it."</li>
<li><strong>New <code>cancel_proposal</code> tool</strong>: Gives the model an escape hatch to withdraw pending proposals instead of waiting forever</li>
</ul>
<p><strong>Result</strong>: In v0.2 eval (10 rollouts with gpt-4.1-mini), <code>accept_proposal</code> calls on own proposals dropped to <strong>zero</strong>.</p>
<h3 id="improved-task-quality-scoring-was-3-weakness">Improved Task Quality Scoring (was #3 weakness)<a class="headerlink" href="#improved-task-quality-scoring-was-3-weakness" title="Permanent link">&para;</a></h3>
<p>The old heuristic used <code>min(len(content) / 80.0, 1.0)</code> â€” any 80+ character string got a perfect score. The new scoring uses three signals:</p>
<table>
<thead>
<tr>
<th>Signal</th>
<th>Old</th>
<th>New</th>
</tr>
</thead>
<tbody>
<tr>
<td>Length</td>
<td>Linear clamp at 80 chars</td>
<td><code>1 - exp(-len/threshold)</code> with difficulty-scaled threshold (80 + difficulty * 120)</td>
</tr>
<tr>
<td>Effort</td>
<td>Binary 0.3 or 0.8</td>
<td><code>sigmoid((len - 30) / 20)</code> â€” smooth gradient</td>
</tr>
<tr>
<td>Relevance</td>
<td>None</td>
<td>Keyword matching against task description terms</td>
</tr>
</tbody>
</table>
<p>A submission must now be longer <em>and</em> mention task-specific terms to score well. This means "Lorem ipsum dolor sit amet..." no longer gets a perfect score.</p>
<h3 id="richer-observations-new">Richer Observations (new)<a class="headerlink" href="#richer-observations-new" title="Permanent link">&para;</a></h3>
<p>The model couldn't see trade outcomes, proposal acceptance rates, or what other agents were doing. New observation sections:</p>
<ul>
<li><strong>Recent Events</strong>: Last 3 events (trade accepted/rejected, audit results, task completions by other agents)</li>
<li><strong>Pending Outgoing Proposals</strong>: "You proposed Trade #3 to agent_0 â€” awaiting response"</li>
<li><strong>Proposal History</strong>: "agent_0: accepted 2/5 proposals from you"</li>
<li><strong>Agent Behavior Hints</strong>: "agent_2 (claimed 3 tasks, submitted 0)" â€” helps identify opportunistic or deceptive bots</li>
</ul>
<h3 id="stochastic-deceptive-bots-was-5-weakness">Stochastic Deceptive Bots (was #5 weakness)<a class="headerlink" href="#stochastic-deceptive-bots-was-5-weakness" title="Permanent link">&para;</a></h3>
<p>Old behavior: hard trust threshold, always exploit with -15 transfer, only target rep &gt; 40 agents. New behavior:</p>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Old</th>
<th>New</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exploit trigger</td>
<td>Hard threshold (interactions &lt; N)</td>
<td>Sigmoid probability: <code>sigmoid((interactions - threshold) * 2)</code></td>
</tr>
<tr>
<td>Exploitation amount</td>
<td>Fixed -15.0</td>
<td>Random <code>uniform(-20, -5)</code></td>
</tr>
<tr>
<td>Post-threshold behavior</td>
<td>100% exploit</td>
<td>70% exploit, 30% still cooperate</td>
</tr>
<tr>
<td>Target selection</td>
<td>Only rep &gt; 40 agents</td>
<td>Any non-frozen agent</td>
</tr>
</tbody>
</table>
<p>Each deceptive bot also gets its own RNG, so they behave independently rather than all flipping to exploit at the same step.</p>
<h3 id="500-scenarios-with-more-variation-was-4-weakness">500 Scenarios with More Variation (was #4 weakness)<a class="headerlink" href="#500-scenarios-with-more-variation-was-4-weakness" title="Permanent link">&para;</a></h3>
<p>The dataset expanded from 200 to 500 scenarios with new variation dimensions:</p>
<table>
<thead>
<tr>
<th>Dimension</th>
<th>Range</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>initial_resources</code></td>
<td>50-150</td>
<td>Some economies start rich, some poor</td>
</tr>
<tr>
<td><code>circuit_breaker_threshold</code></td>
<td>5-20</td>
<td>Some economies are forgiving, some harsh</td>
</tr>
<tr>
<td><code>reputation_decay_rate</code></td>
<td>0.97-1.0</td>
<td>Varying reputation half-lives</td>
</tr>
<tr>
<td><code>task_bounty_multiplier</code></td>
<td>0.5-2.0</td>
<td>Some economies reward tasks more</td>
</tr>
</tbody>
</table>
<p>Plus ~5% extreme scenarios (all-deceptive, all-honest, single-type, high-stakes, sparse) and ~10% phase shift scenarios where governance parameters change mid-simulation (e.g., tax doubles at epoch 3).</p>
<h3 id="social-action-rebalance-was-6-weakness">Social Action Rebalance (was #6 weakness)<a class="headerlink" href="#social-action-rebalance-was-6-weakness" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Action</th>
<th>Old Reward</th>
<th>New Reward</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>post</code></td>
<td>+0.5 reputation</td>
<td>+2.0 reputation</td>
</tr>
<tr>
<td><code>reply</code> (to others)</td>
<td>+0.3 reputation</td>
<td>+1.5 reputation</td>
</tr>
<tr>
<td>Popular posts (3+ votes)</td>
<td>Nothing</td>
<td>One-time resource bonus (up to 5.0)</td>
</tr>
<tr>
<td>Social standing</td>
<td>No effect</td>
<td>Opportunistic bots more likely to accept trades from socially active agents</td>
</tr>
</tbody>
</table>
<h3 id="new-reward-signals-was-2-and-7-weakness">New Reward Signals (was #2 and #7 weakness)<a class="headerlink" href="#new-reward-signals-was-2-and-7-weakness" title="Permanent link">&para;</a></h3>
<p>Two metrics that were previously logged-only now contribute to the training gradient:</p>
<ul>
<li><strong><code>interaction_quality_metric</code></strong> (weight 0.2): Directly rewards higher-quality interactions, pushing past the 1.14 ceiling</li>
<li><strong><code>action_diversity_metric</code></strong> (weight 0.1): Shannon entropy of tool usage distribution â€” encourages exploring all 10 tools rather than spamming <code>propose_trade</code></li>
</ul>
<p>Reputation weight was reduced from 0.6 to 0.3 to keep the total reward range reasonable.</p>
<h3 id="governance-tuning-was-minor">Governance Tuning (was minor)<a class="headerlink" href="#governance-tuning-was-minor" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Mechanism</th>
<th>Old</th>
<th>New</th>
</tr>
</thead>
<tbody>
<tr>
<td>Tax</td>
<td>Flat rate</td>
<td>Progressive: <code>rate * (1 + resources / avg_resources)</code> â€” wealthy agents pay more</td>
</tr>
<tr>
<td>Reputation decay</td>
<td>Uniform 1%/step</td>
<td>Activity-based: idle agents (<code>pass_turn</code>) decay faster</td>
</tr>
<tr>
<td>Circuit breaker</td>
<td>Permanent freeze</td>
<td>Recoverable: frozen agents appeal after 3 steps, reputation resets to threshold + 5</td>
</tr>
</tbody>
</table>
<h3 id="v02-eval-results">v0.2 Eval Results<a class="headerlink" href="#v02-eval-results" title="Permanent link">&para;</a></h3>
<p>We ran 10 rollouts with gpt-4.1-mini (pre-training baseline) to verify the environment works:</p>
<table>
<thead>
<tr>
<th>Metric</th>
<th>v0.1 (step 0)</th>
<th>v0.2 (pre-training)</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Reward</strong></td>
<td>0.808</td>
<td>0.920</td>
</tr>
<tr>
<td>Payoff</td>
<td>0.668</td>
<td>0.663</td>
</tr>
<tr>
<td>Reputation</td>
<td>0.467</td>
<td>0.503</td>
</tr>
<tr>
<td>Interaction quality</td>
<td>0.354</td>
<td>0.254</td>
</tr>
<tr>
<td>Action diversity</td>
<td>N/A</td>
<td>0.546</td>
</tr>
<tr>
<td>Survival</td>
<td>100%</td>
<td>100%</td>
</tr>
<tr>
<td>Self-proposal errors</td>
<td>~4/sim</td>
<td><strong>0</strong></td>
</tr>
</tbody>
</table>
<p>The higher baseline reward (0.92 vs 0.81) reflects the new weighted metrics contributing even without RL training. The environment is ready for the next training run.</p>
<h2 id="reproducing-this">Reproducing This<a class="headerlink" href="#reproducing-this" title="Permanent link">&para;</a></h2>
<p>The environment is published on Prime Intellect Hub as <code>swarm-ai-research/swarm-economy</code>:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># Install</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>prime<span class="w"> </span>env<span class="w"> </span>install<span class="w"> </span>swarm-economy
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="c1"># Evaluate (v0.2)</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>prime<span class="w"> </span><span class="nb">eval</span><span class="w"> </span>run<span class="w"> </span>swarm-economy<span class="w"> </span>--num-examples<span class="w"> </span><span class="m">10</span><span class="w"> </span>--rollouts-per-example<span class="w"> </span><span class="m">1</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="c1"># Train (v0.1 config)</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>prime<span class="w"> </span>rl<span class="w"> </span>run<span class="w"> </span>configs/rl/swarm-economy.toml
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="c1"># Train (v0.2 config â€” medium difficulty, batch_size=64)</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>prime<span class="w"> </span>rl<span class="w"> </span>run<span class="w"> </span>configs/rl/swarm-economy-v2.toml
</span></code></pre></div>
<h2 id="takeaways">Takeaways<a class="headerlink" href="#takeaways" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Multi-agent economies are a rich RL environment.</strong> The combination of tasks, trades, social actions, and governance creates a complex action space where the model develops non-trivial strategies.</p>
</li>
<li>
<p><strong>Thinking models are more robust to RL fine-tuning.</strong> The instruct variant collapsed after the first LoRA update; the thinking variant maintained tool-calling behavior throughout 200 steps. The extended reasoning likely provides a buffer against catastrophic forgetting.</p>
</li>
<li>
<p><strong>Soft probabilistic labels create smooth reward landscapes.</strong> Rather than binary success/failure, the sigmoid-based quality scoring lets the model incrementally improve â€” a 0.86 quality submission is better than 0.70, even though both "succeed."</p>
</li>
<li>
<p><strong>Tool-calling RL works.</strong> The model went from failing to complete simulations (65% truncation) to consistently using all 25 turns with coherent multi-step strategies, all through RL training with no supervised demonstrations.</p>
</li>
<li>
<p><strong>Reward hacking shows up fast.</strong> By step 100, <code>propose_trade</code> dominated at 9.2 calls/step and the model tried to accept its own proposals. Clear system prompts and action diversity rewards are cheap mitigations.</p>
</li>
<li>
<p><strong>Environment iteration matters more than hyperparameter tuning.</strong> The v0.1 reward ceiling (1.14) was caused by environment design issues (gameable scoring, low diversity, missing reward signals), not training config. Fixing the environment directly raises the ceiling.</p>
</li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/swarm-ai-safety/swarm" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/ResearchSwarmAI" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M357.2 48h70.6L273.6 224.2 455 464H313L201.7 318.6 74.5 464H3.8l164.9-188.5L-5.2 48h145.6l100.5 132.9zm-24.8 373.8h39.1L119.1 88h-42z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>